{
  "issue_id": 12443,
  "issue_url": "https://github.com/checkstyle/checkstyle/issues/12443",
  "title": "checkstyle 10.3.3 and newer throws NullPointerException on annotated generic types from IllegalType rule",
  "description_text": "I minimized my repro to narrow down the cause.\r\n\r\nThe config:\r\n\r\n`\u276f /bin/cat checkstyle-configuration.xml`\r\n\r\n```xml\r\n<?xml version=\"1.0\"?>\r\n<!DOCTYPE module PUBLIC\r\n        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\r\n        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\r\n\r\n<module name=\"Checker\">\r\n    <module name=\"TreeWalker\">\r\n        <module name=\"IllegalType\">\r\n            <property name=\"illegalClassNames\"\r\n                    value=\"java.lang.StringBuffer, \" />\r\n        </module>\r\n    </module>\r\n</module>\r\n```\r\n\r\nThe code:\r\n\r\n`\u276f cat ExampleClass.java`\r\n\r\n```java\r\npackage com.example;\r\n\r\nimport java.util.List;\r\n\r\nimport javax.validation.constraints.Pattern;\r\n\r\npublic class ExampleClass\r\n{\r\n    public void example(List<@Pattern String> strings)\r\n    {\r\n    }\r\n}\r\n```\r\n\r\n```bash\r\n\u276f RUN_LOCALE=\"-Duser.language=en -Duser.country=US\"\r\n\u276f java $RUN_LOCALE -jar checkstyle-10.3.3-all.jar -c checkstyle-configuration.xml ExampleClass.java \r\nStarting audit...\r\ncom.puppycrawl.tools.checkstyle.api.CheckstyleException: Exception was thrown while processing ExampleClass.java\r\n\tat com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:307)\r\n\tat com.puppycrawl.tools.checkstyle.Checker.process(Checker.java:224)\r\n\tat com.puppycrawl.tools.checkstyle.Main.runCheckstyle(Main.java:416)\r\n\tat com.puppycrawl.tools.checkstyle.Main.runCli(Main.java:339)\r\n\tat com.puppycrawl.tools.checkstyle.Main.execute(Main.java:196)\r\n\tat com.puppycrawl.tools.checkstyle.Main.main(Main.java:131)\r\nCaused by: java.lang.NullPointerException: Cannot invoke \"com.puppycrawl.tools.checkstyle.api.DetailAST.getLineNo()\" because \"ast\" is null\r\n\tat com.puppycrawl.tools.checkstyle.api.AbstractCheck.log(AbstractCheck.java:276)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.checkIdent(IllegalTypeCheck.java:645)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.checkType(IllegalTypeCheck.java:674)\r\n\tat com.puppycrawl.tools.checkstyle.utils.TokenUtil.forEachChild(TokenUtil.java:244)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.checkTypeArguments(IllegalTypeCheck.java:719)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.checkType(IllegalTypeCheck.java:675)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.checkClassName(IllegalTypeCheck.java:633)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.visitParameterDef(IllegalTypeCheck.java:563)\r\n\tat com.puppycrawl.tools.checkstyle.checks.coding.IllegalTypeCheck.visitToken(IllegalTypeCheck.java:478)\r\n\tat com.puppycrawl.tools.checkstyle.TreeWalker.notifyVisit(TreeWalker.java:336)\r\n\tat com.puppycrawl.tools.checkstyle.TreeWalker.processIter(TreeWalker.java:407)\r\n\tat com.puppycrawl.tools.checkstyle.TreeWalker.walk(TreeWalker.java:274)\r\n\tat com.puppycrawl.tools.checkstyle.TreeWalker.processFiltered(TreeWalker.java:155)\r\n\tat com.puppycrawl.tools.checkstyle.api.AbstractFileSetCheck.process(AbstractFileSetCheck.java:98)\r\n\tat com.puppycrawl.tools.checkstyle.Checker.processFile(Checker.java:335)\r\n\tat com.puppycrawl.tools.checkstyle.Checker.processFiles(Checker.java:294)\r\n\t... 5 more\r\nCheckstyle ends with 1 errors.\r\n\r\n\u276f java $RUN_LOCALE -jar checkstyle-10.3.2-all.jar -c checkstyle-configuration.xml ExampleClass.java\r\nStarting audit...\r\nAudit done.\r\n```\r\n\r\n\r\n---\r\n\r\nNote that any little change to the config file prevents this problem. Even getting rid of the trailing comma or space at the end of StringBuffer in `<property name=\"illegalClassNames\" value=\"java.lang.StringBuffer, \" />` prevents the problem.\r\n\r\n---\r\n\r\n\r\n"
}