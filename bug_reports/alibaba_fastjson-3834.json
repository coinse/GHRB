{
  "issue_id": 3719,
  "issue_url": "https://github.com/alibaba/fastjson/issues/3719",
  "title": "`StringIndexOutOfBoundsException` in `JSONPathParser.next`",
  "description_text": "(from https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=32371)\r\n\r\nThe following reproducer:\r\n\r\n```java\r\nimport java.util.Base64;\r\n\r\nimport com.alibaba.fastjson.JSON;\r\nimport com.alibaba.fastjson.JSONException;\r\n\r\npublic class FastJsonCrash {\r\n    public static String btoa(String base64) {\r\n        return new String(Base64.getDecoder().decode(base64));\r\n    }\r\n    public static void main(String[] args) {\r\n        try {\r\n            JSON.parse(btoa(\"ewogICAgICJzdGFvbnMiOiBbCiAgICAgewogICAgICIkcmVmIjogIi4gICJocmVmIi97VA==\"));\r\n        } catch (JSONException unused) {\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nthrows this exception with the current master branch of fastjson: \r\n\r\n```\r\njava.lang.StringIndexOutOfBoundsException: String index out of range: 3\r\n\tat java.base/java.lang.StringLatin1.charAt(StringLatin1.java:48)\r\n\tat java.base/java.lang.String.charAt(String.java:709)\r\n\tat com.alibaba.fastjson.JSONPath$JSONPathParser.next(JSONPath.java:911)\r\n\tat com.alibaba.fastjson.JSONPath$JSONPathParser.skipWhitespace(JSONPath.java:1038)\r\n\tat com.alibaba.fastjson.JSONPath$JSONPathParser.readName(JSONPath.java:1904)\r\n\tat com.alibaba.fastjson.JSONPath$JSONPathParser.readSegement(JSONPath.java:983)\r\n\tat com.alibaba.fastjson.JSONPath$JSONPathParser.explain(JSONPath.java:1975)\r\n\tat com.alibaba.fastjson.JSONPath.init(JSONPath.java:87)\r\n\tat com.alibaba.fastjson.JSONPath.isRef(JSONPath.java:94)\r\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:458)\r\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:1246)\r\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:533)\r\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parse(DefaultJSONParser.java:1427)\r\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parse(DefaultJSONParser.java:1393)\r\n\tat com.alibaba.fastjson.JSON.parse(JSON.java:181)\r\n\tat com.alibaba.fastjson.JSON.parse(JSON.java:191)\r\n\tat com.alibaba.fastjson.JSON.parse(JSON.java:147)\r\n\tat FastJsonCrash.main(FastJsonCrash.java:12)\r\n```"
}