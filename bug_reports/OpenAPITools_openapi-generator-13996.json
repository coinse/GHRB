{
  "issue_id": 13971,
  "issue_url": "https://github.com/OpenAPITools/openapi-generator/issues/13971",
  "title": "[BUG] [Python] Generated files with syntax errors if spec contains 204 response",
  "description_text": "#### Bug Report Checklist\r\n\r\n- [x] Have you provided a full/minimal spec to reproduce the issue?\r\n- [x] Have you validated the input using an OpenAPI validator ([example](https://apidevtools.org/swagger-parser/online/))?\r\n- [x] Have you [tested with the latest master](https://github.com/OpenAPITools/openapi-generator/wiki/FAQ#how-to-test-with-the-latest-master-of-openapi-generator) to confirm the issue still exists?\r\n- [x] Have you searched for related issues/PRs?\r\n- [x] What's the actual output vs expected output?\r\n- [ ] [Optional] Sponsorship to speed up the bug fix or feature request ([example](https://github.com/OpenAPITools/openapi-generator/issues/6178))\r\n\r\n<!--\r\nPlease follow the issue template below for bug reports.\r\nAlso please indicate in the issue title which language/library is concerned. Eg:  [BUG][JAVA] Bug generating foo with bar \r\n-->\r\n\r\n##### Description\r\n\r\n<!-- describe what is the question, suggestion or issue and why this is a problem for you. -->\r\n\r\nGenerated `python` codes have syntax errors when a spec file contains `204 No Content` response.\r\nThis is caused by type hint `typing.Union` without any type arguments.\r\n\r\n```python\r\n@dataclass\r\nclass ApiResponseFor204(api_client.ApiResponse):\r\n    response: urllib3.HTTPResponse\r\n    body: typing.Union[ # syntax error\r\n    ]\r\n    headers: schemas.Unset = schemas.unset\r\n```\r\n\r\n(Note: `typing.Union` requires one or more type arguments https://docs.python.org/3/library/typing.html#typing.Union)\r\n\r\n##### openapi-generator version\r\n\r\n<!-- which version of openapi-generator are you using, is it a regression? -->\r\n\r\nv6.2.1 (and master branch)\r\n\r\n##### OpenAPI declaration file content or url\r\n\r\n<!-- if it is a bug, a json or yaml that produces it.\r\nIf you post the code inline, please wrap it with\r\n```yaml\r\n(here your code)\r\n```\r\n(for YAML code) or\r\n```json\r\n(here your code)\r\n```\r\n(for JSON code), so it becomes more readable. If it is longer than about ten lines,\r\nplease create a Gist (https://gist.github.com) or upload it somewhere else and\r\nlink it here.\r\n  -->\r\n\r\nGist link: https://gist.githubusercontent.com/Syuparn/0a9d22599b087f61ddfd5beb7bcbc26a/raw/62d003fc54d8df3e97251d6e33103b89a738fd7c/sample.yaml\r\n\r\nThis is originated from  https://swagger.io/docs/specification/2-0/describing-responses/ `Empty Response Body` sample.\r\n\r\n##### Generation Details\r\n\r\n<!-- \r\n    Prefer CLI steps, including the language, libraries and various options. \r\n    Providing config-based settings allows for simpler testing across CLI and plugins. \r\n    For examples, see https://github.com/OpenAPITools/openapi-generator/tree/master/bin/configs\r\n-->\r\n\r\n##### Steps to reproduce\r\n\r\n<!-- unambiguous set of steps to reproduce the bug.-->\r\n\r\n```bash\r\n$ docker run --rm -v \"${PWD}:/local\" openapitools/openapi-generator-cli generate \\\r\n     -i https://gist.githubusercontent.com/Syuparn/0a9d22599b087f61ddfd5beb7bcbc26a/raw/62d003fc54d8df3e97251d6e33103b89a738fd7c/sample.yaml \\\r\n     -g python \\\r\n     -o /local/out/python\r\n```\r\n\r\n`out/python/openapi_client/paths/report/delete.py` has the syntax errors written above.\r\n\r\n##### Related issues/PRs\r\n\r\n- https://github.com/OpenAPITools/openapi-generator/issues/12265\r\n- https://github.com/OpenAPITools/openapi-generator/pull/12287\r\n\r\n##### Suggest a fix\r\n\r\n<!-- if you can't fix the bug yourself, perhaps you can point to what might be\r\n  causing the problem (line of code or commit), or simply make a suggestion -->\r\n\r\nThis type hint should be `schemas.Unset`. Template is intended to render `schemas.Unset` type hint when a body (`content`) is empty.\r\n\r\nhttps://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/resources/python/endpoint.handlebars#L164\r\n\r\nHowever, this is unexpectedly treated as non-empty value because `content`, which is `LinkedHashMap`, is always treated as truthy by conditional blocks `{{#if}}`, `{{#or}}`, and, `{{#and}}`.\r\n\r\n- definition of `content` key https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator/src/main/java/org/openapitools/codegen/CodegenResponse.java#L92\r\n- handlebars function definition (used for `{{#if}}`, `{{#or}}`, `{{#and}}` blocks):  https://github.com/jknack/handlebars.java/blob/master/handlebars/src/main/java/com/github/jknack/handlebars/Handlebars.java#L200\r\n\r\nTo fix the issue, we need another way to check whether `content` is empty (adding boolean flag `hasContent` to `CodegenResponse`  class for example)."
}