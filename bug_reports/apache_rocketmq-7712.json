{
  "issue_id": 7710,
  "issue_url": "https://github.com/apache/rocketmq/issues/7710",
  "title": "[Bug] Deleting the last item problem of the ACL topic/group perms or the global white list caused by the UtilAll#split func flaw",
  "description_text": "### Before Creating the Bug Report\n\n- [X] I found a bug, not just asking a question, which should be created in [GitHub Discussions](https://github.com/apache/rocketmq/discussions).\n\n- [X] I have searched the [GitHub Issues](https://github.com/apache/rocketmq/issues) and [GitHub Discussions](https://github.com/apache/rocketmq/discussions)  of this repository and believe that this is not a duplicate.\n\n- [X] I have confirmed that this bug belongs to the current repository, not other repositories of RocketMQ.\n\n\n### Runtime platform environment\n\nOS(CentOS release 7.6.1810)\n\n### RocketMQ version\n\nbranch(develop) version(5.1.5-SNAPSHOT)\n\n### JDK Version\n\nCompliler(Oracke JDK 1.8.0_361) OS(CentOS release 7.6.1810)\n\n### Describe the Bug\n\nI found an bug of ACL during my work on RocketMQ.\r\nWhen I tried to delete the last item of the ACL topic/group perms, there was an error which indicates the resouce fomat is incrorrect. And there's also an similar problem of the global white list, which is always remain an empty data at last.\n\n### Steps to Reproduce\n\n**To reproduce you can use two ways:**\r\n1. If you use the Dashboard(take the topic/group perms for example)\r\n1.1 Create an ACL with mutiple topic perms and group perms.\r\n1.2 Delete the topic perms or group perms one by one.\r\n1.3 The error woud appear when delete the last one.\r\n\r\n![AgAACF5zlnReY1XDkERMf6P-SgV5fqC1](https://github.com/apache/rocketmq/assets/29912051/10e0ddc4-84a9-4306-9f13-b29a26c2cddc)\r\n![AgAACF5zlnR_G2hISrFGkp9IHvbLVnhw](https://github.com/apache/rocketmq/assets/29912051/641c7900-25ae-422f-b892-78725dba4fe3)\r\n![AgAACF5zlnQIxRfBwMZA4odWFJ1KCjd_](https://github.com/apache/rocketmq/assets/29912051/64ca490f-838a-43da-b16a-92fc2995a509)\r\n\r\n2. If you want to create an test method for reproduce\r\n2.1 New an DefaultMQAdminExt and config it with namesrv and then start it.\r\n2.2 New an PlainAccessConfig and setGroupPerms(Collections.EMPTY_LIST), setTopicPerms(Collections.EMPTY_LIST).\r\n2.3 Then call DefaultMQAdminExt #createAndUpdatePlainAccessConfig.\r\n2.4 Or to call DefaultMQAdminExt #updateGlobalWhiteAddrConfig with the second parmeter an empty string.\r\n\r\n![\u56fe\u7247](https://github.com/apache/rocketmq/assets/29912051/978d469c-a105-4109-bc9a-76491a5b7cbc)\r\n![\u56fe\u7247](https://github.com/apache/rocketmq/assets/29912051/f0c277ee-1e91-4c6e-a627-320c2ac59ec4)\r\n\n\n### What Did You Expect to See?\n\nFor the topic/group perms, it should not be an error to delete the last item.\r\n![\u56fe\u7247](https://github.com/apache/rocketmq/assets/29912051/26cc5b3d-6b9f-455f-a1ba-5c67668dc20f)\r\n\r\n\r\nFor the global white list, it should not be an empty data\r\n\r\n![\u56fe\u7247](https://github.com/apache/rocketmq/assets/29912051/04377834-cdd7-4a6f-a929-c68bd00482ce)\r\n\n\n### What Did You See Instead?\n\nFor the topic/group perms, it popup an error: \r\norg.apache.rocketmq.client.exception.MQClientException: CODE: 209  DESC: Parse Resource format error for .\r\nThe expected resource format is 'Res=Perm'. For example: topicA=SUB\r\n\r\n![AgAACF5zlnReY1XDkERMf6P-SgV5fqC1](https://github.com/apache/rocketmq/assets/29912051/b06c98b8-852e-4227-9d13-dde47df42f03)\r\n\r\nFor the global white list, it remains an empty data\r\n\r\n![AgAACF5zlnR_G2hISrFGkp9IHvbLVnhw](https://github.com/apache/rocketmq/assets/29912051/794828f0-6471-446c-a885-6e4cd4949803)\r\n\n\n### Additional Context\n\n**I've already found and fixed the bug, and I'll submit an PR later.**"
}